<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Webpage with map</title>
<style>
      html, body, #mapArea {
        height: 90%;
        margin: 0px;
        padding: 0px
      }
    </style>
<!-- Google maps javascript API -->
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>
<script type="text/javascript">
var shapeIndicies=[];//array of Polygons index arrays
var jsonStrings =["city-of-wolverhampton-district-b-","epping-forest-district","sefton-district-b-","wychavon-district","york-b-","dundee-city","eden-district","caerffili-caerphilly","farnham-bourne-ward", "surrey-heath-district-b-","guildford-district-b-","reading-b-","rushmoor-district-b-","east-hampshire-district","epsom-and-ewell-district-b-","hammersmith-and-fulham-london-boro","harrow-london-boro","merton-london-boro","islington-london-boro","kensington-and-chelsea-london-boro","barking-and-dagenham-london-boro","tower-hamlets-london-boro","glasgow-city","windsor-and-maidenhead-b-","waltham-forest-london-boro","wandsworth-london-boro","city-and-county-of-the-city-of-london","barnet-london-boro","enfield-london-boro","greenwich-london-boro","hackney-london-boro","haringey-london-boro","hillingdon-london-boro","southwark-london-boro","boston-district-b-"];
var map;
var indicies;
var shapes=[];
var shown;
   
function setUpMap(){
	var mapOptions = {
		     zoom: 13,
		     center: new google.maps.LatLng(51.2, -0.8)
		  };
	map = new google.maps.Map(document.getElementById('mapArea'),
		      mapOptions);
	setUpShapes();
}
function downloadShape(url){
	var xmlhttp = new XMLHttpRequest();
	xmlhttp.onreadystatechange = function() {
	if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
		setUpShape(JSON.parse(xmlhttp.responseText));
	    }
	}
	xmlhttp.open("GET", url, false);
	xmlhttp.send();
}
function setUpShape(jsonData){//Name actually a lie, as once made, a shape's colour is fixed. Could, however, be made to create a shapeOptions that totally defines a shape instead
	var points = jsonData.geometry.coordinates[0];
	//alert(points.length);
	shown=false;
	for(i=0;i<points.length;i++){
		indicies[indicies.length]= new google.maps.LatLng(points[i][1],points[i][0]);//may need to swap order
	}
	//shapeIndicies[shapeIndicies.length] = indicies;
}
function setUpShapes(){
	shapes=[];
	indicies = [];
	fillColor = colors[colors.length-2];
	strokeColor = colors[colors.length-1];
	for(var i=0;i<jsonStrings.length;i++){
		downloadShape("https://sturents.com/geo/"+jsonStrings[i]+".json");
	}
	shapeIndicies[shapeIndicies.length] = indicies

}
function test(){
   if(shown==true){
	   for(i=0;i<shapes.length;i++){
			shapes[i].setMap(null);
			shapes[i]=null;
	   }
	   shapes=[];
   }else{//shapes created here so can set colour
	   for(i=0;i<shapeIndicies.length;i++){
		   shapes[i] = new google.maps.Polygon({
				 paths: indicies,
				 strokeColor: strokeColor,
				 strokeOpacity: 0.8,
				 strokeWeight: 3,
				 fill: 0.5,
				 fillColor: fillColor
				 });
		   shapes[i].setMap(map);
		   shiftHighlightOptions();
	   }
   }
   shown=!shown;
}
var col=0;
var colors = ["#000000","#ff0000","#00ff00","#ffff00","#0000ff","#ff00ff","#00ffff","#ffffff","#8f0000","#008f00","#8f8f00","#00008f","#8f008f","#008f8f","#8f8f8f"];
var fillColor;
var strokeColor;
//causes the fill/strokeColor to iterate through various colours
function shiftHighlightOptions(){
	fillColor =strokeColor;
	strokeColor = colors[col];
	col++;
	if(col==colors.length){
		col=0;
	}
}

google.maps.event.addDomListener(window, 'load', setUpMap);
</script>
</head>
<body>
<p>
Map will go below when put in.
</p>
<div id="mapArea"></div>
<input type="button" onclick="test()" value="No, click ME" />
</body>
</html>